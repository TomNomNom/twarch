<!doctype html>
<html lang="en">
  <head>
    <title></title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style>
      body {
        font-family: sans-serif;
      }
      time {
        color: #CCC;
        padding-left: 1em;
      }
      li {
        margin: 1em;
      }
    </style>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  </head>
  <body>
    <h1>Tweets</h1>
    <form>
      <input type="text" id="term">
    </form>

    <ol id="results"></ol>

    <script>
      $(function(){
        var termField = $('#term');
        var resultsList = $('#results');

        var state = { lastTerm: '' };

        var findTweets = function(){

          var term = termField.val()
          if (term != state.lastTerm){ 
            $.get('/find.php', {"term": term}, function(data){
              var html = '';
              $(data).each(function(key, tweet){
                html += '<li>'+tweet.text+' <time>'+tweet.created+'</time></li>';
              });
              resultsList.html(html);
            })
          }
          
          state.lastTerm = term;
          setTimeout(findTweets, 500);
        };

        findTweets();

      });
    </script>
  </body>
</html>
